input {
  file {
    path => "/usr/share/logstash/data/vn/*.csv"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => csv {
      separator => ","
      columns => ["Nom Affaire","Libellé court","Numéro dossier","No client","Nom client","Date de livraison client","Date facture","Libellé marque","Libellé gamme","Vin","Immatriculation","Libellé version","Type (achat ou vente)","Montant HT","Montant TTC","Code site","No facture","Code facture","Type facture","Date d'immatriculation","Code énergie","Libellé énergie","Date d'achat","Date de commande client","Date de mise à disposition","Date de mise en circulation","Référence extension de garantie","Durée extension de garantie","Kilométrage extension de garantie","Libellé financement","Libellé organisme de financement","Montant des mensualités","Montant apport","Date de commande du véhicule","Genre","Incidence stock","Date comptabilisation facture","Date écheance compte client","No Commande Constructeur","Puissance","Libellé conseiller commercial 1","Libellé financier","Montant financé","Durée de financement","Montant des reprises","Date avis de vente","Type du VD","Date de mise en VD","Kilométrage du VD","Montant TTC du VD","Commentaire VD","Commentaire BDC","No Commande","Commentaire véhicule","Teinte véhicule","Libellé type de VD","Libellé site long","Ville site","Libellé situation","Date naissance client","Prénom client","Rue client","Complément adresse 1 client","Complément adresse 2 client","Lieu dit client","Code postal client","Commune client","Tél. domicile client","Tél. professionnel client","Tél. portable client","Civilité (Libellé) client","Libellé catégorie","Libellé (opt,fac,cess)","Code (opt,fac,cess)","Email client","Libellé site court","Kilométrage"]
    }
    type => "sampleA"
  }

  file {
    path => "/usr/share/logstash/data/apj/*.csv"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => csv {
      separator => ","
      columns => ["No ligne","Nom Affaire","No bon","No facture","Date facture","N° compte client","Libellé intervention","Référence","Montant facture","Gamme Modele","Immatriculation","VIN","Km","Date livraison","Dossier VNVO associé","Commentaire général","Commentaire complément facture","Commentaire client","Commentaire général","Date contrôle technique","Type facture","Avoir/Facture","Montant HT facture","Date échéance facture","Date de règlement","Numéro client payeur","Civilité payeur","Date naissance payeur","Nom payeur","Prénom payeur","Email payeur","Rue payeur","Complément adresse 1 payeur","Complément adresse 2 payeur","Code postal payeur","Commune payeur","Tél. domicile payeur","Tél. professionnel payeur","Tél. portable payeur","No client utilisateur","Civilité utilisateur","Date naissance utilisateur","Nom utilisateur","Prénom utilisateur","Email utilisateur","Rue utilisateur","Complément adresse 1 utilisateur","Complément adresse 2 utilisateur","Code postal utilisateur","Commune utilisateur","Tél. domicile utilisateur","Tél. professionnel utilisateur","Tél. portable utilisateur","Type Profil utilisateur","Marque (Libellé)","Type véhicule","Km restitution","Date de restitution","Date livraison VO","Date de mise en circulation","Date entrée du véhicule","Energie","Libellé carrosserie","No client propriétaire","Nom propriétaire","Prénom propriétaire","Email propriétaire","Rue propriétaire","Complément adresse 1 propriétaire","Complément adresse 2 propriétaire","Code postal propriétaire","Commune propriétaire","Tél. domicile propriétaire","Tél. professionnel propriétaire","Tél. portable propriétaire","Montant net","Type ligne (PR/MO/DIV)","Client Commande client","Code intervention","Libellé / Désignation","Libellé forfait","Code produit","Quantité servie","Quantité répartie"]
    }
    type => "sampleB"
  }
}

filter {
  if [type] == "sampleA" {
    mutate {
      rename => {
        "Nom Affaire" => "nom_affaire"
        "Libellé court" => "libelle"
        "No client" => "no_client"
      }
      # Add other transformations here for sampleA
    }
               prune {
                 whitelist_names => ["nom_affaire", "libelle", "no_client"]
               }
  }

  if [type] == "sampleB" {
    mutate {
      rename => {
        "Libellé intervention" => "libelle"
        "Nom Affaire" => "nom_affaire"
        "N° compte client" => "no_client"
      }
      # Add other transformations here for sampleB
    }
              prune {
                whitelist_names => ["nom_affaire", "libelle", "no_client"]
              }
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "datalog"
  }
  stdout { codec => rubydebug }
}
